{"version":3,"file":"SpatialCanvas-DlHenAF1.js","sources":["../../src/modules/Nivel_1_Views/OMD-09_ISK/components/SpatialCanvas.jsx"],"sourcesContent":["/**\n * üé® SPATIAL CANVAS (Zone B) - Versi√≥n 2.1 \"Axiomatic Engine\"\n * \n * SOBERAN√çA: Implementaci√≥n Canonizada seg√∫n ISK_Structural_Law.\n * Utiliza tokens CSS maestros de stark_theme.css.\n */\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport './SpatialCanvas.css';\n\nexport const SpatialCanvas = () => {\n    const [entities, setEntities] = useState([]);\n    const [selectedId, setSelectedId] = useState(null);\n    const [canvasScale, setCanvasScale] = useState(1);\n    const [viewMode, setViewMode] = useState('INFINITE'); // De la Ley 9.1\n    const stageRef = useRef(null);\n\n    // --- ESCUCHA DE REALIDAD (M√≥dulos externos) ---\n    useEffect(() => {\n        const handleSpawn = (e) => {\n            const { type, x, y } = e.detail;\n            const newEntity = {\n                id: `ent_${Date.now()}`,\n                type,\n                x: x || 100,\n                y: y || 100,\n                w: 120,\n                h: 80,\n                fill: 'var(--accent-primary)',\n                label: `New ${type}`,\n                opacity: 0.9,\n                links: []\n            };\n            setEntities(prev => [...prev, newEntity]);\n        };\n\n        window.addEventListener('isk-spawn-entity', handleSpawn);\n        return () => window.removeEventListener('isk-spawn-entity', handleSpawn);\n    }, [entities.length]);\n\n    // --- SELECCI√ìN Y EMISI√ìN (Traducci√≥n a Pivotes de la Ley) ---\n    const handleSelect = (id) => {\n        setSelectedId(id);\n        const entity = entities.find(e => e.id === id);\n\n        // Emisi√≥n CAN√ìNICA alineada con el Inspector Pivot System\n        window.dispatchEvent(new CustomEvent('isk-entity-selected', {\n            detail: {\n                id: entity.id,\n                type: entity.type,\n                // Estructura de pivotes seg√∫n ley 9.2\n                pivots: {\n                    GEOMETRY: {\n                        transform: { x: entity.x, y: entity.y, z: 0 },\n                        dimension: { w: entity.w, h: entity.h },\n                        style: { fill: entity.fill, opacity: entity.opacity }\n                    },\n                    REACTION: {\n                        logic: { label: entity.label },\n                        links: entity.links\n                    },\n                    ASSETS: {\n                        image: { src: '' }\n                    }\n                }\n            }\n        }));\n    };\n\n    return (\n        <div\n            className={`spatial-stage ${viewMode.toLowerCase()}`}\n            ref={stageRef}\n            onClick={() => setSelectedId(null)}\n        >\n            <div className=\"canvas-grid-overlay\"></div>\n\n            <div className=\"entities-layer\" style={{ transform: `scale(${canvasScale})` }}>\n                {entities.map(ent => (\n                    <div\n                        key={ent.id}\n                        className={`spatial-entity ${ent.type.toLowerCase()} ${selectedId === ent.id ? 'active' : ''}`}\n                        onClick={(e) => { e.stopPropagation(); handleSelect(ent.id); }}\n                        style={{\n                            left: ent.x,\n                            top: ent.y,\n                            width: ent.w,\n                            height: ent.h,\n                            backgroundColor: ent.fill,\n                            opacity: ent.opacity\n                        }}\n                    >\n                        <span className=\"entity-label\">{ent.label}</span>\n                    </div>\n                ))}\n            </div>\n\n            <div className=\"canvas-viewport-hud glass\">\n                <span className=\"mode-indicator\">{viewMode} VIEW</span>\n                <div className=\"hud-controls\">\n                    <button onClick={() => setCanvasScale(s => Math.min(s + 0.1, 2))}>+</button>\n                    <button onClick={() => setCanvasScale(s => Math.max(s - 0.1, 0.5))}>-</button>\n                    <button onClick={() => setViewMode(v => v === 'INFINITE' ? 'PAGED' : 'INFINITE')}>‚ö°</button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default SpatialCanvas;\n"],"names":["SpatialCanvas","entities","setEntities","useState","selectedId","setSelectedId","canvasScale","setCanvasScale","viewMode","setViewMode","stageRef","useRef","useEffect","handleSpawn","e","type","x","y","newEntity","prev","handleSelect","id","entity","jsxs","jsx","ent","s","v"],"mappings":"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"}